<div class="content-header">
  <div class="container-fluid">
    <div class="row mb-2 align-items-center">
      <div class="col-sm-6 d-flex align-items-center">
        <i class="fas fa-ticket-alt fa-lg text-primary mr-2"></i>
        <h1 class="m-0 text-dark">Booking #<%= @booking.id %></h1>
      </div>
      <div class="col-sm-6 text-right">
        <%= link_to "Back to Bookings", bookings_path, class: "btn btn-secondary" %>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid">
  <div class="row justify-content-center">
    <div class="col-md-10">
      <div class="card card-primary card-outline shadow-sm mb-4">
        <div class="card-body">
          <div class="row mb-4">
            <div class="col-md-8">
              <h4 class="font-weight-bold mb-2">Booking Details</h4>
              <p class="mb-1 text-muted">Created: <%= @booking.created_at.strftime("%B %d, %Y at %I:%M %p") %></p>
              <% case @booking.status %>
              <% when "confirmed" %>
                <span class="badge badge-success"><i class="fas fa-check mr-1"></i>Confirmed</span>
              <% when "pending" %>
                <span class="badge badge-warning"><i class="fas fa-hourglass-half mr-1"></i>Pending Payment</span>
              <% when "cancelled" %>
                <span class="badge badge-danger"><i class="fas fa-times mr-1"></i>Cancelled</span>
              <% end %>
            </div>
            <div class="col-md-4 text-right">
              <% if @booking.status == "pending" && !@booking.payment %>
                <%= link_to "Complete Payment", new_booking_payment_path(@booking), class: "btn btn-warning" %>
              <% end %>
            </div>
          </div>

          <% if flash[:notice] %>
            <div class="alert alert-success">
              <%= flash[:notice] %>
            </div>
          <% end %>

          <div class="row">
            <div class="col-md-6">
              <div class="card mb-3">
                <div class="card-header bg-light font-weight-bold">
                  Event Information
                </div>
                <div class="card-body">
                  <p><strong>Event:</strong> <%= @booking.event.title %></p>
                  <p><strong>Location:</strong> <%= @booking.event.location %></p>
                  <p><strong>Date:</strong> <%= @booking.event.start_time.strftime("%B %d, %Y at %I:%M %p") %></p>
                </div>
              </div>
              <div class="card mb-3">
                <div class="card-header bg-light font-weight-bold">
                  Customer Information
                </div>
                <div class="card-body">
                  <p><strong>Name:</strong> <%= @booking.name %></p>
                  <p><strong>Email:</strong> <%= @booking.email_address %></p>
                  <p><strong>Phone:</strong> <%= @booking.phone_number %></p>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card mb-3">
                <div class="card-header bg-light font-weight-bold">
                  Ticket Details
                </div>
                <div class="card-body">
                  <p><strong>Ticket Type:</strong> <%= @booking.ticket_type.name %></p>
                  <p><strong>Number of Tickets:</strong> <%= @booking.tickets %></p>
                  <p><strong>Price per Ticket:</strong> <%= number_to_currency(@booking.ticket_type.price) %></p>
                  <hr>
                  <p class="h5"><strong>Total Amount:</strong>
                    <span class="text-success"><%= number_to_currency(@booking.total_price) %></span>
                  </p>
                </div>
              </div>
              <% if @booking.payment %>
                <div class="card mb-3 border-success">
                  <div class="card-header bg-success text-white font-weight-bold">
                    Payment Information
                  </div>
                  <div class="card-body">
                    <p><strong>Payment Method:</strong> <%= @booking.payment.payment_method.titleize %></p>
                    <p><strong>Transaction Reference:</strong> <%= @booking.payment.transaction_ref %></p>
                    <p><strong>Payment Status:</strong>
                      <span class="badge badge-primary"><%= @booking.payment.status.titleize %></span>
                    </p>
                    <p><strong>Payment Date:</strong> <%= @booking.payment.created_at.strftime("%B %d, %Y at %I:%M %p") %></p>
                  </div>
                </div>
              <% elsif @booking.status == "pending" %>
                <div class="alert alert-warning">
                  This booking is pending payment. Please complete payment to confirm your booking.
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>