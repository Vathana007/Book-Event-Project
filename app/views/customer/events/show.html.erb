<!-- filepath: /home/chort-sereivathana/Documents/book-event-project/event-booking/app/views/customer/events/show.html.erb -->
<div class="container-fluid py-4">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card card-primary card-outline shadow-lg">
        <% if @event.image&.attached? %>
          <%= image_tag @event.image, class: "card-img-top rounded-top mb-3", style: "max-height: 320px; object-fit: cover;" %>
        <% end %>
        <div class="card-body">
          <h1 class="h3 font-weight-bold text-dark mb-3"><%= @event.title %></h1>
          <p class="mb-2 text-secondary"><i class="fas fa-calendar-alt mr-1"></i> <%= @event.start_time.strftime("%B %d, %Y %I:%M %p") %></p>
          <p class="mb-2 text-secondary"><i class="fas fa-map-marker-alt mr-1"></i> <%= @event.location %></p>
          <p class="text-muted mb-4"><%= @event.description %></p>

          <h5 class="font-weight-bold text-dark mt-4 mb-2">Ticket Types</h5>
          <% if @ticket_types.any? %>
            <table class="table table-bordered mb-4">
              <thead class="thead-light">
                <tr>
                  <th>Type</th>
                  <th>Price</th>
                  <th>Available</th>
                </tr>
              </thead>
              <tbody>
                <% @ticket_types.each do |tt| %>
                  <tr>
                    <td><span class="badge badge-primary"><%= tt.name %></span></td>
                    <td><span class="badge badge-info"><%= number_to_currency(tt.price) %></span></td>
                    <td><span class="badge badge-success"><%= tt.available_tickets %></span></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          <% else %>
            <div class="alert alert-warning">No ticket types available for this event.</div>
          <% end %>

          <div class="mt-4">
            <% if @ticket_types.any? && @ticket_types.any? { |tt| tt.available_tickets > 0 } %>
              <%= link_to "Book Now", new_event_booking_path(@event), class: "btn btn-primary btn-lg" %>
            <% else %>
              <span class="btn btn-secondary btn-lg disabled">Sold Out</span>
            <% end %>
          </div>
          <div class="mt-3">
            <%= link_to "Back to Events", customer_events_path, class: "btn btn-link text-primary font-weight-bold" %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>