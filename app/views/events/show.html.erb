<div class="content-header">
  <div class="container-fluid">
    <div class="row mb-2">
      <div class="col-sm-6 d-flex align-items-center">
        <i class="fas fa-calendar-alt mr-2 text-primary"></i>
        <h1 class="m-0 text-dark"><%= @event.title %></h1>
      </div>
      <div class="col-sm-6 text-right">
        <%= link_to edit_event_path(@event), class: "btn btn-warning mr-2" do %>
          <i class="fas fa-edit"></i> Edit
        <% end %>
        <%= link_to events_path, class: "btn btn-secondary" do %>
          <i class="fas fa-arrow-left"></i> Back
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid">
  <div class="row justify-content-center">
    <div class="col-md-10">
      <div class="card card-primary card-outline shadow-sm mb-4">
        <div class="card-body">
          <div class="row">
            <div class="col-md-5">
              <% if @event.image&.attached? %>
                <%= image_tag @event.image.variant(resize_to_limit: [400, 300]), class: "img-fluid rounded shadow mb-3" %>
              <% end %>
              <p>
                <span class="badge badge-info">
                  <i class="fas fa-tag mr-1"></i> <%= @event.category.name %>
                </span>
              </p>
              <p>
                <i class="fas fa-location-dot mr-2 text-gray-400"></i>
                <%= @event.location %>
              </p>
              <p>
                <i class="fas fa-calendar-days text-blue-600 mr-2"></i>
                <%= @event.start_time.strftime("%A, %d %B %Y %I:%M %p") %> -
                <%= @event.end_time.strftime("%I:%M %p") %>
              </p>
            </div>
            <div class="col-md-7">
              <h4 class="font-weight-bold mb-3">About this event</h4>
              <p class="text-muted"><%= @event.description %></p>
              <hr>
              <h5 class="font-weight-bold mb-2">Ticket Types</h5>
              <% if @event.ticket_types.any? %>
                <% @event.ticket_types.each do |ticket_type| %>
                  <div class="mb-3 p-3 border rounded d-flex justify-content-between align-items-center">
                    <div>
                      <span class="font-weight-bold"><%= ticket_type.name %></span>
                      <span class="badge badge-success ml-2">$<%= number_with_precision(ticket_type.price, precision: 2) %></span>
                      <span class="badge badge-info ml-2">Available: <%= ticket_type.available_tickets %></span>
                    </div>
                    <div>
                      <% if ticket_type.available_tickets > 0 %>
                        <%= link_to "Book", new_event_ticket_type_booking_path(@event, ticket_type), class: "btn btn-primary btn-sm" %>
                      <% else %>
                        <span class="badge badge-danger">Sold Out</span>
                      <% end %>
                    </div>
                  </div>
                <% end %>
              <% else %>
                <div class="alert alert-warning">
                  <i class="fas fa-exclamation-triangle mr-2"></i>
                  No ticket types available for this event.
                </div>
              <% end %>
              <%= link_to "Manage Ticket Types", event_ticket_types_path(@event), class: "btn btn-secondary mt-3" %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>